!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r(require("react")):"function"==typeof define&&define.amd?define(["react"],r):"object"==typeof exports?exports.RouterResolver=r(require("react")):e.RouterResolver=r(e.React)}(this,function(e){return function(e){function r(n){if(t[n])return t[n].exports;var o=t[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}var t={};return r.m=e,r.c=t,r.p="",r(0)}([function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var o=t(1),a=n(o);r["default"]=a["default"],e.exports=r["default"]},function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function a(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}Object.defineProperty(r,"__esModule",{value:!0});var s=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},u=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),i=function(e,r,t){for(var n=!0;n;){var o=e,a=r,s=t;n=!1,null===o&&(o=Function.prototype);var u=Object.getOwnPropertyDescriptor(o,a);if(void 0!==u){if("value"in u)return u.value;var i=u.get;if(void 0===i)return;return i.call(s)}var l=Object.getPrototypeOf(o);if(null===l)return;e=l,r=a,t=s,n=!0,u=l=void 0}},l=t(2),p=n(l),c=t(3),f=n(c),d=t(9),v=n(d),m=function(e){return e.pathname+e.search+e.hash},h=function(e,r){var t=m(e),n=m(r);return t!==n},y=function(e){var r=[],t=function(e){e.resolve&&r.push(e)};return e.forEach(function(e){if("object"==typeof e)for(var r in e)t(e[r]);else t(e)}),r},g=function(e,r){for(var t=[],n=0;n<r.length;n++)-1===e.indexOf(r[n])&&t.push(r[n]);return t},b=function(e,r){var t=void 0,n=0,o=0;for(t in e){if(e.hasOwnProperty(t)&&e[t]!==r[t])return!1;n++}for(t in r)r.hasOwnProperty(t)&&o++;return n===o},O=function(e){return e[e.length-1]},P=function(e,r){e.components=e.components||[],e.responses=e.responses||[],r.components=r.components||[],r.responses=r.responses||[];for(var t=0;t<r.components.length;t++){var n=r.components[t],o=e.components.indexOf(n);-1===o?(e.components.push(r.components[t]),e.responses.push(r.responses[t])):e.responses[o]=r.responses[t]}return e},R=function(e){return JSON.parse(JSON.stringify(e))},_=function(e){function r(){o(this,r),i(Object.getPrototypeOf(r.prototype),"constructor",this).apply(this,arguments),this.state={resolving:!1,resolveError:!1,prevProps:null,componentsResponses:null}}return a(r,e),u(r,[{key:"getChildContext",value:function(){return{resolver:{componentsResponses:this.state.componentsResponses}}}},{key:"componentDidMount",value:function(){var e=this.props,r=e.components,t=e.params;this.resolve(r,t)}},{key:"componentWillReceiveProps",value:function(e){if(h(e.location,this.props.location)){var r=y(this.props.components),t=y(e.components),n=g(r,t);if(0!==t.length&&0===n.length){var o=b(r,t);if(o){var a=!b(e.params,this.props.params);a&&(n=[O(t)])}}this.resolve(n,e.params)}}},{key:"resolve",value:function(e,r){var t=this;this.setState({resolving:!0,prevProps:this.props});var n=this.state.componentsResponses||{},o=y(e),a=o.map(function(e){return e.resolve(r)});Promise.all(a).then(function(e){var r={components:o,responses:e};n=P(n,r),t.setState({resolving:!1,resolveError:!1,prevProps:null,componentsResponses:n})},function(e){t.setState({resolving:!1,resolveError:!0}),t.props.onError&&t.props.onError(e)})}},{key:"render",value:function(){var e=this.state,r=e.componentsResponses,t=e.resolving,n=e.resolveError,o=e.prevProps;if(!r)return this.props.renderInitial();var a=t||n?o:this.props,u=this.props.params||{},i=R(u);return i.resolving=this.state.resolving,p["default"].createElement(f["default"],s({},a,{params:i,createElement:v["default"]}))}}],[{key:"propTypes",value:{components:p["default"].PropTypes.array.isRequired,params:p["default"].PropTypes.object.isRequired,location:p["default"].PropTypes.object.isRequired,renderInitial:p["default"].PropTypes.func,onError:p["default"].PropTypes.func},enumerable:!0},{key:"defaultProps",value:{renderInitial:function(){return null}},enumerable:!0},{key:"childContextTypes",value:{resolver:p["default"].PropTypes.object},enumerable:!0}]),r}(p["default"].Component);r["default"]=_,e.exports=r["default"]},function(r,t){r.exports=e},function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function a(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}r.__esModule=!0;var s=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},u=t(4),i=n(u),l=t(2),p=n(l),c=t(5),f=t(7),d=n(f),v=p["default"].PropTypes,m=v.array,h=v.func,y=v.object,g=function(e){function r(){o(this,r),e.apply(this,arguments)}return a(r,e),r.prototype.getChildContext=function(){var e=this.props,r=e.history,t=e.location;return{history:r,location:t}},r.prototype.createElement=function(e,r){return null==e?null:this.props.createElement(e,r)},r.prototype.render=function(){var e=this,r=this.props,t=r.history,n=r.location,o=r.routes,a=r.params,u=r.components,l=null;return u&&(l=u.reduceRight(function(r,u,i){if(null==u)return r;var l=o[i],p=d["default"](l,a),f={history:t,location:n,params:a,route:l,routeParams:p,routes:o};if(c.isReactChildren(r))f.children=r;else if(r)for(var v in r)r.hasOwnProperty(v)&&(f[v]=r[v]);if("object"==typeof u){var m={};for(var h in u)u.hasOwnProperty(h)&&(m[h]=e.createElement(u[h],s({key:h},f)));return m}return e.createElement(u,f)},l)),null===l||l===!1||p["default"].isValidElement(l)?void 0:i["default"](!1),l},r}(l.Component);g.propTypes={history:y.isRequired,createElement:h.isRequired,location:y.isRequired,routes:m.isRequired,params:y.isRequired,components:m.isRequired},g.defaultProps={createElement:p["default"].createElement},g.childContextTypes={history:y.isRequired,location:y.isRequired},r["default"]=g,e.exports=r["default"]},function(e,r,t){"use strict";var n=function(e,r,t,n,o,a,s,u){if(!e){var i;if(void 0===r)i=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[t,n,o,a,s,u],p=0;i=new Error(r.replace(/%s/g,function(){return l[p++]})),i.name="Invariant Violation"}throw i.framesToPop=1,i}};e.exports=n},function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return null==e||d["default"].isValidElement(e)}function a(e){return o(e)||Array.isArray(e)&&e.every(o)}function s(e,r,t){e=e||"UnknownComponent";for(var n in r)if(r.hasOwnProperty(n)){var o=r[n](t,n,e);o instanceof Error}}function u(e,r){return c({},e,r)}function i(e){var r=e.type,t=u(r.defaultProps,e.props);if(r.propTypes&&s(r.displayName||r.name,r.propTypes,t),t.children){var n=l(t.children,t);n.length&&(t.childRoutes=n),delete t.children}return t}function l(e,r){var t=[];return d["default"].Children.forEach(e,function(e){if(d["default"].isValidElement(e))if(e.type.createRouteFromReactElement){var n=e.type.createRouteFromReactElement(e,r);n&&t.push(n)}else t.push(i(e))}),t}function p(e){return a(e)?e=l(e):e&&!Array.isArray(e)&&(e=[e]),e}r.__esModule=!0;var c=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e};r.isReactChildren=a,r.createRouteFromReactElement=i,r.createRoutesFromReactChildren=l,r.createRoutes=p;var f=t(2),d=n(f),v=t(6);n(v)},function(e,r,t){"use strict";var n=function(){};e.exports=n},function(e,r,t){"use strict";function n(e,r){var t={};if(!e.path)return t;var n=o.getParamNames(e.path);for(var a in r)r.hasOwnProperty(a)&&-1!==n.indexOf(a)&&(t[a]=r[a]);return t}r.__esModule=!0;var o=t(8);r["default"]=n,e.exports=r["default"]},function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function a(e){return o(e).replace(/\/+/g,"/+")}function s(e){for(var r="",t=[],n=[],o=void 0,s=0,u=/:([a-zA-Z_$][a-zA-Z0-9_$]*)|\*\*|\*|\(|\)/g;o=u.exec(e);)o.index!==s&&(n.push(e.slice(s,o.index)),r+=a(e.slice(s,o.index))),o[1]?(r+="([^/?#]+)",t.push(o[1])):"**"===o[0]?(r+="([\\s\\S]*)",t.push("splat")):"*"===o[0]?(r+="([\\s\\S]*?)",t.push("splat")):"("===o[0]?r+="(?:":")"===o[0]&&(r+=")?"),n.push(o[0]),s=u.lastIndex;return s!==e.length&&(n.push(e.slice(s,e.length)),r+=a(e.slice(s,e.length))),{pattern:e,regexpSource:r,paramNames:t,tokens:n}}function u(e){return e in v||(v[e]=s(e)),v[e]}function i(e,r){"/"!==e.charAt(0)&&(e="/"+e),"/"!==r.charAt(0)&&(r="/"+r);var t=u(e),n=t.regexpSource,o=t.paramNames,a=t.tokens;n+="/*";var s="*"!==a[a.length-1];s&&(n+="([\\s\\S]*?)");var i=r.match(new RegExp("^"+n+"$","i")),l=void 0,p=void 0;if(null!=i){if(s){l=i.pop();var c=i[0].substr(0,i[0].length-l.length);if(l&&"/"!==c.charAt(c.length-1))return{remainingPathname:null,paramNames:o,paramValues:null}}else l="";p=i.slice(1).map(function(e){return null!=e?decodeURIComponent(e):e})}else l=p=null;return{remainingPathname:l,paramNames:o,paramValues:p}}function l(e){return u(e).paramNames}function p(e,r){var t=i(e,r),n=t.paramNames,o=t.paramValues;return null!=o?n.reduce(function(e,r,t){return e[r]=o[t],e},{}):null}function c(e,r){r=r||{};for(var t=u(e),n=t.tokens,o=0,a="",s=0,i=void 0,l=void 0,p=void 0,c=0,f=n.length;f>c;++c)i=n[c],"*"===i||"**"===i?(p=Array.isArray(r.splat)?r.splat[s++]:r.splat,null!=p||o>0?void 0:d["default"](!1),null!=p&&(a+=encodeURI(p))):"("===i?o+=1:")"===i?o-=1:":"===i.charAt(0)?(l=i.substring(1),p=r[l],null!=p||o>0?void 0:d["default"](!1),null!=p&&(a+=encodeURIComponent(p))):a+=i;return a.replace(/\/+/g,"/")}r.__esModule=!0,r.compilePattern=u,r.matchPattern=i,r.getParamNames=l,r.getParams=p,r.formatPattern=c;var f=t(4),d=n(f),v={}},function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},a=t(2),s=n(a),u=t(10),i=n(u),l=function(e){return JSON.parse(JSON.stringify(e))},p=function(e,r){var t=l(r.params);delete t.resolving;var n=r.params.resolving;return e.resolve?s["default"].createElement(i["default"],{Component:e,routerProps:r,params:t,resolving:n}):s["default"].createElement(e,o({},r,{params:t,resolving:n}))};r["default"]=p,e.exports=r["default"]},function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function a(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}Object.defineProperty(r,"__esModule",{value:!0});var s=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},u=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),i=function(e,r,t){for(var n=!0;n;){var o=e,a=r,s=t;n=!1,null===o&&(o=Function.prototype);var u=Object.getOwnPropertyDescriptor(o,a);if(void 0!==u){if("value"in u)return u.value;var i=u.get;if(void 0===i)return;return i.call(s)}var l=Object.getPrototypeOf(o);if(null===l)return;e=l,r=a,t=s,n=!0,u=l=void 0}},l=t(2),p=n(l),c=function(e,r){var t=r.components,n=r.responses,o=t.indexOf(e);return n[o]},f=function(e){function r(){o(this,r),i(Object.getPrototypeOf(r.prototype),"constructor",this).apply(this,arguments)}return a(r,e),u(r,[{key:"render",value:function(){var e=this.props,r=e.Component,t=e.routerProps,n=e.params,o=this.context.resolver.componentsResponses,a=c(r,o);return a?p["default"].createElement(r,s({},t,{params:n,response:a})):null}}],[{key:"propTypes",value:{Component:p["default"].PropTypes.func.isRequired,routerProps:p["default"].PropTypes.object.isRequired,params:p["default"].PropTypes.object.isRequired},enumerable:!0},{key:"contextTypes",value:{resolver:p["default"].PropTypes.object.isRequired},enumerable:!0}]),r}(p["default"].Component);r["default"]=f,e.exports=r["default"]}])});